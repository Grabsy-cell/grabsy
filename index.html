// Your Google Sheet CSV export link
const sheetURL = "https://docs.google.com/spreadsheets/d/1UzfheO8LeHtje8jUZeugkd_vxb-rA2F0MB6YGerWyk/gviz/tq?tqx=out:csv";

async function loadProducts() {
    const response = await fetch(sheetURL);
    const data = await response.text();

    // Parse CSV
    const rows = data.split("\n").map(row => row.split(","));
    const headers = rows[0];
    const products = rows.slice(1).map(row => {
        let item = {};
        headers.forEach((h, i) => {
            item[h.trim()] = row[i] ? row[i].trim() : "";
        });
        return item;
    });

    displayProducts(products);
}

function displayProducts(products) {
    const container = document.getElementById("product-list");
    container.innerHTML = "";

    products.forEach(p => {
        if (!p["Product Name"]) return; // skip empty rows

        const card = document.createElement("div");
        card.className = "product-card";

        card.innerHTML = `
            <img src="${p["Image URL"]}" alt="${p["Product Name"]}">
            <h3>${p["Product Name"]}</h3>
            <p>${p["Description"]}</p>
            <a href="${p["Amazon Link"]}" target="_blank" class="buy-btn">Buy on Amazon</a>
        `;

        container.appendChild(card);
    });
}

loadProducts();
